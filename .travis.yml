sudo: required
services:
  - docker
addons:
  apt:
    packages:
    - python3
    - python3-pip
before_install:
  - sudo pip3 install SolrClient
  - docker build -t solr .
  - docker run -d -u 1234:0 -p 8983:8983 solr
  - |
    while ! [[ $(curl -s -o /dev/null -w "%{http_code}" "http://localhost:8983/solr/nice2_index/update?commit=true&wt=json") = 200 ]]; do
        echo "waiting for Solr to become ready"
        sleep 1;
    done
script:
  - ./test.py
